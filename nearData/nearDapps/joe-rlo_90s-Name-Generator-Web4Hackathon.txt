*GitHub Repository "joe-rlo/90s-Name-Generator-Web4Hackathon"*

'''--- Cargo.toml ---
[package]
name = "web4-demo"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
near-sdk = "4.0.0-pre.7"

[lib]
crate-type = ["cdylib"]

[profile.release]
codegen-units = 1
# Tell `rustc` to optimize for small code size.
opt-level = "z"
lto = true
debug = false
panic = "abort"
# Opt into extra safety checks on arithmetic operations https://stackoverflow.com/a/64136471/249801
overflow-checks = true

'''
'''--- README.md ---

90s Wallet Name Generator
==========================

A totally rad site that let's you generate a killer name. You can then check if it already exists before trying creating it or whatever.

Just don't have a cow if its already taken.

Party on dawg!

Uses:

* [Web4](https://web4.near.page) is a gateway to the smart contracts deployed to NEAR protocol.
* NEAR API JS
* JQuery CLI (just to add some fun in the experience)
'''
'''--- res/index.html ---
<!DOCTYPE html>
<html lang="en">
<head>
	  <title>Ready Layer One 90s Wallet Name Generator</title>
	  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/nearprotocol/near-api-js/dist/near-api-js.js"></script>
	<style>
		html, body{
	-webkit-font-smoothing:antialiased;
	font-family: "Comic Sans MS", sans-serif;
	line-height:1.4;
	margin:0 auto;
	max-width:860px;
	height: 100%;
}
.center{
	text-align: center;
}
.intro{
	font-size:4em;
}
.max {
    display: block;
    width: 860px;
    word-wrap: break-word;
}
.bg2{
	background-image: url("http://readylayerone.s3.amazonaws.com/Ready-Layer-One-Background.jpg");
}
a{
	color: #000000;
}
pre{
	color: #ffffff;
}
button{
  height:  40px;
  font-family: "Comic Sans MS", sans-serif;
}

.container {
    width: 100%;
    height: 100%;
    border: 2px solid black;
    box-sizing: border-box;
}
h1, h2, h3, p, a, .command{
  color: yellow;
}
span.line{
  color: red;
}

#main{
  min-height: 90vh;
}
section{
  display: none;
}
.open{
  display: block;
}

/* @group Blink */
.blink {
	-webkit-animation: blink .75s linear infinite;
	-moz-animation: blink .75s linear infinite;
	-ms-animation: blink .75s linear infinite;
	-o-animation: blink .75s linear infinite;
	 animation: blink .75s linear infinite;
}
@-webkit-keyframes blink {
	0% { opacity: 1; }
	50% { opacity: 1; }
	50.01% { opacity: 0; }
	100% { opacity: 0; }
}
@-moz-keyframes blink {
	0% { opacity: 1; }
	50% { opacity: 1; }
	50.01% { opacity: 0; }
	100% { opacity: 0; }
}
@-ms-keyframes blink {
	0% { opacity: 1; }
	50% { opacity: 1; }
	50.01% { opacity: 0; }
	100% { opacity: 0; }
}
@-o-keyframes blink {
	0% { opacity: 1; }
	50% { opacity: 1; }
	50.01% { opacity: 0; }
	100% { opacity: 0; }
}
@keyframes blink {
	0% { opacity: 1; }
	50% { opacity: 1; }
	50.01% { opacity: 0; }
	100% { opacity: 0; }
}
/* @end */

/*for footer*/
.blinking {
  margin: auto 0;
  display:inline-block;
  font-size: 12px;
  border: 10px solid #9ae2ff;
  animation-name: blinking;
  animation-duration: 1s;
  animation-iteration-count: 2000;
}
@keyframes blinking {
  50% {
    border-color: #ffcd5f;
  }
}
	</style>
</head>
<body class="center bg2">
<div id="main">
<h2 class="tab blink">Welcome to the NEAR future!</h2>
<marquee><pre>
      ___           ___           ___           ___
     /__/\         /  /\         /  /\         /  /\
     \  \:\       /  /:/_       /  /::\       /  /::\
      \  \:\     /  /:/ /\     /  /:/\:\     /  /:/\:\
  _____\__\:\   /  /:/ /:/_   /  /:/~/::\   /  /:/~/:/
 /__/::::::::\ /__/:/ /:/ /\ /__/:/ /:/\:\ /__/:/ /:/___
 \  \:\~~\~~\/ \  \:\/:/ /:/ \  \:\/:/__\/ \  \:\/:::::/
  \  \:\  ~~~   \  \::/ /:/   \  \::/       \  \::/~~~~
   \  \:\        \  \:\/:/     \  \:\        \  \:\
    \  \:\        \  \::/       \  \:\        \  \:\
     \__\/         \__\/         \__\/         \__\/
 </pre>
</marquee>
<main>

<h2>90s Wallet Name Generator<h2>
<button onclick="generator()" class="btn btn-primary btn-block btn-large">Generate!</button>
<h2 id="name">[[Your Totally Rad Name Will Appear Here]]</h2>
<section id="start">
	<p>Once you have generated a name, enter the address of your wallet to see if its available (ie, readylayerone.near).</p>
</p>
</section>
<span class="command">near:/$<input type="text" id="nameCheck" placeholder="Type here"></span>
<h3><span>&raquo;Press <button onclick="checkName()">here</button> to check <small>(you can edit it first)</small></small></span></h3>
<section id="wallet-found">
<h2><span>&raquo;Doh! Wallet Already Exists :( Sorry, Please Try Again</span></h2>
</p>
</section>

<section id="wallet-notfound">
<h2><span>&raquo;Woohoo! Wallet Name Is Available! Party On!</span></h2>
<p>	Let's use <a href="https://shard.dog/go" target="_blank">ShardDog</a> and create your wallet for free!<br/>
</p>
</section>
</main>
<footer id="footer">
<img src="https://i.imgur.com/i6hvJjx.gif">
<p><---JOIN MY WEBRING ---></p>
<span><img src="https://i.imgur.com/QkBkUkC.gif"></span>
<br/>
<div class='blinking'><a href="https://twitter.com/ready_layer_one" target="_blank">Follow Us On Twttr</a></div>
</footer>
<script>
	/*!
 * jQuery CLI
 * Simulating a command line interface with jQuery
 *
 * @version : 1.0.0
 * @author : Paulo Nunes (http://syndicatefx.com)
 * @demo : https://codepen.io/syndicatefx/pen/jPxXpz
 * @license: MIT
 */

/*!*
 * jQuery Text Typer plugin
 * https://github.com/gr8pathik/jquery-texttyper
*/
(function(e){"use strict";e.fn.textTyper=function(t){var n={typingClass:"typing",beforeAnimation:function(){},afterAnimation:function(){},speed:50,nextLineDelay:400,startsFrom:0,repeatAnimation:false,repeatDelay:4e3,repeatTimes:1,cursorHtml:'<span class="cursor">|</span>'},r=e.extend({},n,t);this.each(function(){var t=e(this),n=1,i="typingCursor";var s=t,o=s.length,u=[];while(o--){u[o]=e.trim(e(s[o]).html());e(s[o]).html("")}t.init=function(e){var n=r.beforeAnimation;if(n)n();t.animate(0)};t.animate=function(o){var a=s[o],f=r.typingClass,l=r.startsFrom;e(a).addClass(f);var c=setInterval(function(){var f=r.cursorHtml;f=e("<div>").append(e(f).addClass(i)).html();e(a).html(u[o].substr(0,l)+f);l++;if(u[o].length<l){clearInterval(c);o++;if(s[o]){setTimeout(function(){e(a).html(u[o-1]);t.animate(o)},r.nextLineDelay)}else{e(a).find("."+i).remove();if(r.repeatAnimation&&(r.repeatTimes==0||n<r.repeatTimes)){setTimeout(function(){t.animate(0);n++},r.repeatDelay)}else{var h=r.afterAnimation;if(h)h()}}}},r.speed)};t.init()});return this}})(jQuery)

// Let's do it!!
$(document).ready(function() {

  $('.command').hide();
  $('input[type="text"]').focus();
  $('#start').addClass('open');
  $('#start').textTyper({
        speed:20,
        afterAnimation:function(){
          $('.command').fadeIn();
          $('input[type="text"]').focus();
          $('input[type="text"]').val('');
        }
      });

// get array of section ids, that exist in DOM
var sectionArray = [];
// We are using <section> here, you can use <div> or <article> if you want
$('section').each( function(i,e) {
    //you can use e.id instead of $(e).attr('id')
    sectionArray.push($(e).attr('id'));
});

// Debug
//console.log(sectionArray);

// configure minimal network settings and key storage
const config = {
  nodeUrl: "https://rpc.mainnet.near.org",
  deps: {
    keyStore: new nearApi.keyStores.BrowserLocalStorageKeyStore(),
  },
};

// Command Input------------------------------

  $('input[type="text"]').keyup(function(e){

    if(e.which == 13){// ENTER key pressed

      $('.command').hide();
      var destination = $('input[type="text"]').val().toLowerCase();
      //step based logic
        // open a connection to the NEAR platform
        (async function () {
          window.near = await nearApi.connect(config);
          try{
              const account = await near.account($('input[type="text"]').val().toLowerCase());
              const response = await account.state();
              console.log(response);
               destination = "wallet-found";
               $('section[id="' + destination + '"]').addClass('open').siblings().removeClass('open');
          } catch(err) {
             destination = "wallet-notfound";
            $('section[id="' + destination + '"]').addClass('open').siblings().removeClass('open');
          }
        })(window);

      // Display section with id == destination and hide all others
      $('section[id="' + destination + '"]').addClass('open').siblings().removeClass('open');
      //if you need to do something right before the winoow opens

      // If destination does not match our array of section ids, display error section
      if($.inArray(destination, sectionArray) == -1){
        $('#error').addClass('open');
        $('#error').siblings().removeClass('open');
      }

      // All sections with class .open init textTyper
      $('.open').textTyper({
        speed:20,
        afterAnimation:function(){
          $('.command').fadeIn();
          $('input[type="text"]').focus();
          $('input[type="text"]').val('');
        }
      });

    }// end if ENTER key pressed

  });// end keyup function

// End Command Input-----------------------------

});

function checkName(e){
  const config = {
  nodeUrl: "https://rpc.mainnet.near.org",
  deps: {
    keyStore: new nearApi.keyStores.BrowserLocalStorageKeyStore(),
  },
};

$('.command').hide();
var destination = $('input[type="text"]').val().toLowerCase();
//step based logic
  // open a connection to the NEAR platform
  (async function () {
    window.near = await nearApi.connect(config);
    try{
        const account = await near.account($('input[type="text"]').val().toLowerCase());
        const response = await account.state();
        console.log(response);
         destination = "wallet-found";
         $('section[id="' + destination + '"]').addClass('open').siblings().removeClass('open');
    } catch(err) {
       destination = "wallet-notfound";
      $('section[id="' + destination + '"]').addClass('open').siblings().removeClass('open');
    }
  })(window);

// Display section with id == destination and hide all others
$('section[id="' + destination + '"]').addClass('open').siblings().removeClass('open');
//if you need to do something right before the winoow opens

// If destination does not match our array of section ids, display error section
if($.inArray(destination, sectionArray) == -1){
  $('#error').addClass('open');
  $('#error').siblings().removeClass('open');
}

// All sections with class .open init textTyper
$('.open').textTyper({
  speed:20,
  afterAnimation:function(){
    $('.command').fadeIn();
    $('input[type="text"]').focus();
    $('input[type="text"]').val('');
  }
});

}// end keyup function

var adjective = ["Aiite","Asif","Blazin","DaBomb","Booyah","Bounce","Buggin","Chedda","Cowabunga","Crunk","Farout","Flossin","Fly","Hella","Lame","Peep","Phat","Props","Salty","Scrub","Shady","Sick","Steppin","Sweet","Tight","Triflin","Trippin","Rad","Tubular","Whack","Dillio","Wicked","Word","Wheezingthejuice","Whoop","Yo","Youngin"]
var object = ["Taco", "Bartman", "Soda", "Bling","Yoink","Whatever","Dawg","Walkman","Tamagotchi","Beeper","CDRom","Discman","BeenieBaby","Troll","GameBoy","Slime","Furbie","RollerBlade","EctoCooler","TrapperKeeper"]
var list;

function generator() {
  document.getElementById("nameCheck").value = "";
  var genName = adjective[Math.floor(Math.random() * adjective.length)] + "" + object[Math.floor(Math.random() * object.length)]+".near";
  document.getElementById("name").innerHTML = genName;
  document.getElementById("nameCheck").value = genName;
}

</script>
</body>
</html>
'''
'''--- src/lib.rs ---
mod web4;

use near_sdk::borsh::{self, BorshDeserialize, BorshSerialize};
use near_sdk::serde::{Deserialize, Serialize};
use near_sdk::{near_bindgen, AccountId};

#[near_bindgen]
#[derive(BorshDeserialize, BorshSerialize, Default)]
pub struct Contract {}
'''
'''--- src/utils.rs ---
pub(crate) mod u128_dec_format {
    use near_sdk::serde::de;
    use near_sdk::serde::{Deserialize, Deserializer};

    pub fn deserialize<'de, D>(deserializer: D) -> Result<u128, D::Error>
        where
            D: Deserializer<'de>,
    {
        String::deserialize(deserializer)?
            .parse()
            .map_err(de::Error::custom)
    }
}

pub(crate) mod u64_dec_format {
    use near_sdk::serde::de;
    use near_sdk::serde::{Deserialize, Deserializer};

    pub fn deserialize<'de, D>(deserializer: D) -> Result<u64, D::Error>
        where
            D: Deserializer<'de>,
    {
        String::deserialize(deserializer)?
            .parse()
            .map_err(de::Error::custom)
    }
}

'''
'''--- src/web4.rs ---
use crate::*;

use near_sdk::json_types::Base64VecU8;
use near_sdk::{env};
use std::collections::HashMap;

#[allow(dead_code)]
#[derive(Serialize, Deserialize)]
#[serde(crate = "near_sdk::serde")]
pub struct Web4Request {
    #[serde(rename = "accountId")]
    account_id: Option<AccountId>,
    path: String,
    params: Option<HashMap<String, String>>,
    query: Option<HashMap<String, Vec<String>>>,
    preloads: Option<HashMap<String, Web4Response>>,
}

#[derive(Serialize, Deserialize, Default)]
#[serde(crate = "near_sdk::serde")]
pub struct Web4Response {
    #[serde(rename = "contentType")]
    content_type: Option<String>,
    status: Option<u32>,
    body: Option<Base64VecU8>,
    #[serde(rename = "bodyUrl")]
    body_url: Option<String>,
    #[serde(rename = "preloadUrls")]
    preload_urls: Option<Vec<String>>,
}

impl Web4Response {
    pub fn html_response(text: String) -> Self {
        Self {
            content_type: Some(String::from("text/html; charset=UTF-8")),
            body: Some(text.into_bytes().into()),
            ..Default::default()
        }
    }

    pub fn plain_response(text: String) -> Self {
        Self {
            content_type: Some(String::from("text/plain; charset=UTF-8")),
            body: Some(text.into_bytes().into()),
            ..Default::default()
        }
    }

    pub fn preload_urls(urls: Vec<String>) -> Self {
        Self {
            preload_urls: Some(urls),
            ..Default::default()
        }
    }

    pub fn body_url(url: String) -> Self {
        Self {
            body_url: Some(url),
            ..Default::default()
        }
    }

    pub fn status(status: u32) -> Self {
        Self {
            status: Some(status),
            ..Default::default()
        }
    }
}

#[near_bindgen]
impl Contract {
    #[allow(unused_variables)]
    pub fn web4_get(&self, request: Web4Request) -> Web4Response {
        let path = request.path;

        if path == "/robots.txt" {
            return Web4Response::plain_response("User-agent: *\nDisallow:".to_string());
        }

        Web4Response::html_response(
            include_str!("../res/index.html").to_string()
        )

    }
}
'''